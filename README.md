# Neo4j Graph Analyzer

A comprehensive tool for analyzing Neo4j graph structures, specifically designed for code analysis graphs generated by the LLM Code Grapher.

## Features

- **Hierarchical Analysis**: Analyze graph structure level by level starting from Program nodes
- **Database Switching**: Support for multiple Neo4j databases
- **Relationship Mapping**: Detailed analysis of relationship types and patterns
- **Path Analysis**: Find most common paths through the graph
- **Code Analysis Comparison**: Compare code file analysis between two databases
- **Discrepancy Detection**: Identify differences in parsing and analysis results
- **Multiple Output Formats**: Table and JSON output options
- **Export Capabilities**: Save analysis results to files

## Installation

1. Install dependencies:
```bash
pip install -r graph_analyzer_requirements.txt
```

2. Make the script executable:
```bash
chmod +x graph_analyzer.py
```

## Quick Start

### Basic Analysis
```bash
python graph_analyzer.py --uri bolt://localhost:7687 --user neo4j --password password
```

### Analyze Specific Database
```bash
python graph_analyzer.py --uri bolt://localhost:7687 --user neo4j --password password --database fraud_db
```

### Export Results
```bash
python graph_analyzer.py --uri bolt://localhost:7687 --user neo4j --password password --export analysis.json
```

### Compare Two Database Analyses
```bash
python compare_analysis.py --file code.cbl --db1 database1 --db2 database2
```

### Compare with Export
```bash
python compare_analysis.py --file code.cbl --db1 database1 --db2 database2 --export comparison.json
```

## Usage Examples

See [graph_analyzer_examples.md](graph_analyzer_examples.md) for detailed usage examples and sample outputs.

## Configuration

Use [graph_analyzer_config.yaml](graph_analyzer_config.yaml) to define multiple database connections and default settings.

## Command Line Options

- `--uri`: Neo4j database URI (required)
- `--user`: Neo4j username (required)
- `--password`: Neo4j password (required)
- `--database`: Database name (default: neo4j)
- `--max-depth`: Maximum analysis depth (default: 4)
- `--output`: Output format - table or json (default: table)
- `--export`: Export results to JSON file

## Output

The analyzer provides:

1. **Database Summary**: Total nodes, relationships, and type counts
2. **Hierarchical Structure**: Level-by-level breakdown of node types
3. **Relationship Analysis**: Most common relationship patterns
4. **Path Analysis**: Most frequent paths through the graph
5. **Export Options**: JSON export for further analysis

## Integration with LLM Code Grapher

This tool is specifically designed to work with graphs generated by the LLM Code Grapher's Neo4j integration. It understands the typical structure:

- **Program** nodes at the root
- **Section** and **Subsection** nodes for code organization
- **Operation** nodes for individual code operations
- **BusinessRule** nodes for business logic
- **DEPENDS_ON**, **CONTAINS**, **IMPLEMENTS**, **NEXT** relationships

## Troubleshooting

- Ensure Neo4j is running and accessible
- Verify database credentials and permissions
- Check that the target database exists
- For large graphs, consider reducing max-depth for better performance

## License

Part of the LLM Code Grapher project.
